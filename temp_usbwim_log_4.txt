[2025-11-30 19:15:53] [Info] === USB Tools Session Started ===
[2025-11-30 19:15:53] [Info] Log file: d:\usbwim.log
[2025-11-30 19:15:53] [Info] Starting restore operation
[2025-11-30 19:15:53] [Info] Source WIM: D:\test.usbwim
[2025-11-30 19:15:53] [Info] Target Drive: g:
[2025-11-30 19:15:53] [Info] Provider: auto
[2025-11-30 19:15:53] [Info] Boot Mode: auto
[2025-11-30 19:15:53] [Info] Target Disk: 2
[2025-11-30 19:15:53] [Info] Reading WIM metadata...
[2025-11-30 19:15:53] [Info] Validating disk 2 is a USB drive...
[2025-11-30 19:15:55] [Info] Disk 2 validated as USB drive
[2025-11-30 19:15:55] [Info] Preparing disk...
[2025-11-30 19:15:55] [Info] Target Disk Size: 30,976,404,480 bytes
[2025-11-30 19:15:55] [Info] Source Image Size: 30,976,404,480 bytes
[2025-11-30 19:15:55] [Info] Resizing partition 2 (FAT32) to fill disk.
[2025-11-30 19:15:55] [Info] Preparing Disk 2 using Native WMI...
[2025-11-30 19:15:55] [Info] Clearing Disk 2...
[2025-11-30 19:15:55] [Info] Parameters: Disk=2, BootMode=auto, TargetStyle=MBR
[2025-11-30 19:16:01] [Info] Initializing Disk 2 as GPT...
[2025-11-30 19:16:01] [Warning] Initialize failed with 41001 (Already Initialized). Verifying disk state...
[2025-11-30 19:16:01] [Info] Retrying Clear operation...
[2025-11-30 19:16:07] [Info] Retrying initialization as GPT...
[2025-11-30 19:16:07] [Error] Native WMI Disk Preparation Failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 455
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 326
[2025-11-30 19:16:07] [Error] Restore operation failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 455
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 326
   at USBTools.RestoreCommand.ExecuteAsync(String sourceWim, String targetDrive, String diskNumberStr, Boolean autoYes, String provider, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 90
[2025-11-30 19:16:43] [Info] === USB Tools Session Started ===
[2025-11-30 19:16:43] [Info] Log file: d:\usbwim.log
[2025-11-30 19:16:43] [Info] Starting restore operation
[2025-11-30 19:16:43] [Info] Source WIM: D:\test.usbwim
[2025-11-30 19:16:43] [Info] Target Drive: g:
[2025-11-30 19:16:43] [Info] Provider: auto
[2025-11-30 19:16:43] [Info] Boot Mode: auto
[2025-11-30 19:16:43] [Info] Target Disk: 2
[2025-11-30 19:16:43] [Info] Reading WIM metadata...
[2025-11-30 19:16:43] [Info] Validating disk 2 is a USB drive...
[2025-11-30 19:16:45] [Info] Disk 2 validated as USB drive
[2025-11-30 19:16:45] [Info] Preparing disk...
[2025-11-30 19:16:45] [Info] Target Disk Size: 30,976,404,480 bytes
[2025-11-30 19:16:45] [Info] Source Image Size: 30,976,404,480 bytes
[2025-11-30 19:16:45] [Info] Resizing partition 2 (FAT32) to fill disk.
[2025-11-30 19:16:45] [Info] Preparing Disk 2 using Native WMI...
[2025-11-30 19:16:45] [Info] Clearing Disk 2...
[2025-11-30 19:16:45] [Info] Parameters: Disk=2, BootMode=auto, TargetStyle=MBR
[2025-11-30 19:16:51] [Info] Initializing Disk 2 as GPT...
[2025-11-30 19:16:51] [Warning] Initialize failed with 41001 (Already Initialized). Verifying disk state...
[2025-11-30 19:16:51] [Info] Retrying Clear operation...
[2025-11-30 19:16:57] [Info] Retrying initialization as GPT...
[2025-11-30 19:16:57] [Error] Native WMI Disk Preparation Failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 455
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 326
[2025-11-30 19:16:57] [Error] Restore operation failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 455
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 326
   at USBTools.RestoreCommand.ExecuteAsync(String sourceWim, String targetDrive, String diskNumberStr, Boolean autoYes, String provider, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 90
[2025-11-30 19:17:33] [Info] === USB Tools Session Started ===
[2025-11-30 19:17:33] [Info] Log file: d:\usbwim.log
[2025-11-30 19:17:33] [Info] Starting restore operation
[2025-11-30 19:17:33] [Info] Source WIM: D:\test.usbwim
[2025-11-30 19:17:33] [Info] Target Drive: g:
[2025-11-30 19:17:33] [Info] Provider: auto
[2025-11-30 19:17:33] [Info] Boot Mode: auto
[2025-11-30 19:17:33] [Info] Target Disk: 2
[2025-11-30 19:17:33] [Info] Reading WIM metadata...
[2025-11-30 19:17:33] [Info] Validating disk 2 is a USB drive...
[2025-11-30 19:17:35] [Info] Disk 2 validated as USB drive
[2025-11-30 19:17:35] [Info] Preparing disk...
[2025-11-30 19:17:35] [Info] Target Disk Size: 30,976,404,480 bytes
[2025-11-30 19:17:35] [Info] Source Image Size: 30,976,404,480 bytes
[2025-11-30 19:17:35] [Info] Resizing partition 2 (FAT32) to fill disk.
[2025-11-30 19:17:35] [Info] Preparing Disk 2 using Native WMI...
[2025-11-30 19:17:35] [Info] Clearing Disk 2...
[2025-11-30 19:17:35] [Info] Parameters: Disk=2, BootMode=auto, TargetStyle=MBR
[2025-11-30 19:17:41] [Info] Initializing Disk 2 as GPT...
[2025-11-30 19:17:41] [Warning] Initialize failed with 41001 (Already Initialized). Verifying disk state...
[2025-11-30 19:17:41] [Info] Retrying Clear operation...
[2025-11-30 19:17:47] [Info] Retrying initialization as GPT...
[2025-11-30 19:17:47] [Error] Native WMI Disk Preparation Failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 455
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 326
[2025-11-30 19:17:47] [Error] Restore operation failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 455
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 326
   at USBTools.RestoreCommand.ExecuteAsync(String sourceWim, String targetDrive, String diskNumberStr, Boolean autoYes, String provider, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 90
[2025-11-30 19:22:52] [Info] === USB Tools Session Started ===
[2025-11-30 19:22:52] [Info] Log file: d:\usbwim.log
[2025-11-30 19:22:52] [Info] Starting restore operation
[2025-11-30 19:22:52] [Info] Source WIM: D:\test.usbwim
[2025-11-30 19:22:52] [Info] Target Drive: g:
[2025-11-30 19:22:52] [Info] Provider: auto
[2025-11-30 19:22:52] [Info] Boot Mode: auto
[2025-11-30 19:22:52] [Info] Target Disk: 2
[2025-11-30 19:22:52] [Info] Reading WIM metadata...
[2025-11-30 19:22:52] [Info] Validating disk 2 is a USB drive...
[2025-11-30 19:22:54] [Info] Disk 2 validated as USB drive
[2025-11-30 19:22:54] [Info] Preparing disk...
[2025-11-30 19:22:54] [Info] Target Disk Size: 30,976,404,480 bytes
[2025-11-30 19:22:54] [Info] Source Image Size: 30,976,404,480 bytes
[2025-11-30 19:22:54] [Info] Resizing partition 2 (FAT32) to fill disk.
[2025-11-30 19:22:54] [Info] Preparing Disk 2 using Native WMI...
[2025-11-30 19:22:54] [Info] Clearing Disk 2...
[2025-11-30 19:22:54] [Info] Parameters: Disk=2, BootMode=auto, TargetStyle=MBR
[2025-11-30 19:22:59] [Info] Initializing Disk 2 as GPT...
[2025-11-30 19:23:00] [Warning] Initialize failed with 41001 (Already Initialized). Verifying disk state...
[2025-11-30 19:23:00] [Warning] Disk is initialized as 1 (1=MBR, 2=GPT) but requested 2. Attempting native disk header wipe...
[2025-11-30 19:23:00] [Info] Writing 1048576 bytes of zeros to start of disk...
[2025-11-30 19:23:00] [Info] Disk header wiped successfully.
[2025-11-30 19:23:00] [Info] Retrying Clear operation...
[2025-11-30 19:23:06] [Info] Retrying initialization as GPT...
[2025-11-30 19:23:06] [Error] Native WMI Disk Preparation Failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 450
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 321
[2025-11-30 19:23:06] [Error] Restore operation failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 450
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 321
   at USBTools.RestoreCommand.ExecuteAsync(String sourceWim, String targetDrive, String diskNumberStr, Boolean autoYes, String provider, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 90
[2025-11-30 19:25:47] [Info] === USB Tools Session Started ===
[2025-11-30 19:25:47] [Info] Log file: d:\usbwim.log
[2025-11-30 19:25:47] [Info] Starting restore operation
[2025-11-30 19:25:47] [Info] Source WIM: D:\test.usbwim
[2025-11-30 19:25:47] [Info] Target Drive: g:
[2025-11-30 19:25:47] [Info] Provider: auto
[2025-11-30 19:25:47] [Info] Boot Mode: auto
[2025-11-30 19:25:47] [Info] Target Disk: 2
[2025-11-30 19:25:47] [Info] Reading WIM metadata...
[2025-11-30 19:25:47] [Info] Validating disk 2 is a USB drive...
[2025-11-30 19:25:49] [Info] Disk 2 validated as USB drive
[2025-11-30 19:25:49] [Info] Preparing disk...
[2025-11-30 19:25:49] [Info] Target Disk Size: 30,976,404,480 bytes
[2025-11-30 19:25:49] [Info] Source Image Size: 30,976,404,480 bytes
[2025-11-30 19:25:49] [Info] Resizing partition 2 (FAT32) to fill disk.
[2025-11-30 19:25:49] [Info] Preparing Disk 2 using Native WMI...
[2025-11-30 19:25:49] [Info] Clearing Disk 2...
[2025-11-30 19:25:49] [Info] Parameters: Disk=2, BootMode=auto, TargetStyle=MBR
[2025-11-30 19:25:55] [Info] Initializing Disk 2 as GPT...
[2025-11-30 19:25:55] [Warning] Initialize failed with 41001 (Already Initialized). Verifying disk state...
[2025-11-30 19:25:55] [Warning] Disk is initialized as 1 (1=MBR, 2=GPT) but requested 2. Attempting native disk header wipe...
[2025-11-30 19:25:56] [Info] Writing 1048576 bytes of zeros to start of disk...
[2025-11-30 19:25:56] [Info] Disk header wiped successfully.
[2025-11-30 19:25:56] [Warning] Warning: Failed to update disk properties. Error: 122
[2025-11-30 19:25:56] [Info] Retrying Clear operation...
[2025-11-30 19:26:01] [Info] Retrying initialization as GPT...
[2025-11-30 19:26:01] [Error] Native WMI Disk Preparation Failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 450
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 321
[2025-11-30 19:26:01] [Error] Restore operation failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 450
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 321
   at USBTools.RestoreCommand.ExecuteAsync(String sourceWim, String targetDrive, String diskNumberStr, Boolean autoYes, String provider, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 90
[2025-11-30 19:29:45] [Info] === USB Tools Session Started ===
[2025-11-30 19:29:45] [Info] Log file: d:\usbwim.log
[2025-11-30 19:29:45] [Info] Starting restore operation
[2025-11-30 19:29:45] [Info] Source WIM: D:\test.usbwim
[2025-11-30 19:29:45] [Info] Target Drive: g:
[2025-11-30 19:29:45] [Info] Provider: auto
[2025-11-30 19:29:45] [Info] Boot Mode: auto
[2025-11-30 19:29:45] [Info] Target Disk: 2
[2025-11-30 19:29:45] [Info] Reading WIM metadata...
[2025-11-30 19:29:45] [Info] Validating disk 2 is a USB drive...
[2025-11-30 19:29:47] [Info] Disk 2 validated as USB drive
[2025-11-30 19:29:47] [Info] Preparing disk...
[2025-11-30 19:29:48] [Info] Target Disk Size: 30,976,404,480 bytes
[2025-11-30 19:29:48] [Info] Source Image Size: 30,976,404,480 bytes
[2025-11-30 19:29:48] [Info] Resizing partition 2 (FAT32) to fill disk.
[2025-11-30 19:29:48] [Info] Preparing Disk 2 using Native WMI...
[2025-11-30 19:29:48] [Info] Clearing Disk 2...
[2025-11-30 19:29:48] [Info] Parameters: Disk=2, BootMode=auto, TargetStyle=MBR
[2025-11-30 19:29:53] [Info] Initializing Disk 2 as GPT...
[2025-11-30 19:29:53] [Warning] Initialize failed with 41001 (Already Initialized). Verifying disk state...
[2025-11-30 19:29:53] [Warning] Disk is initialized as 1 (1=MBR, 2=GPT) but requested 2. Attempting native disk header wipe...
[2025-11-30 19:29:54] [Info] Writing 1048576 bytes of zeros to start of disk...
[2025-11-30 19:29:54] [Info] Disk header wiped successfully.
[2025-11-30 19:29:54] [Warning] Warning: Failed to update disk properties. Error: 122
[2025-11-30 19:29:54] [Info] Cycling disk Offline/Online to force partition table refresh...
[2025-11-30 19:29:54] [Warning] Warning: Disk Offline/Online cycle failed: WMI Method Offline failed with return code 1
[2025-11-30 19:29:54] [Info] Retrying Clear operation...
[2025-11-30 19:30:00] [Info] Retrying initialization as GPT...
[2025-11-30 19:30:00] [Error] Native WMI Disk Preparation Failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 464
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 335
[2025-11-30 19:30:00] [Error] Restore operation failed: WMI Method Initialize failed with return code 41001
   at USBTools.RestoreCommand.InvokeWmiMethod(ManagementObject obj, String methodName, ManagementBaseObject inParams) in D:\GitHub\usbtools\RestoreCommand.cs:line 464
   at USBTools.RestoreCommand.PrepareDisk(Int32 diskNumber, DriveGeometry geometry, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 335
   at USBTools.RestoreCommand.ExecuteAsync(String sourceWim, String targetDrive, String diskNumberStr, Boolean autoYes, String provider, String bootMode) in D:\GitHub\usbtools\RestoreCommand.cs:line 90
